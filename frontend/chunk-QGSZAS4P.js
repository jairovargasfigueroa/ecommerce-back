import{a as ue}from"./chunk-H75MTFYF.js";import{N as x,P as M,Q as te,R as E,l as K,p as U,q as W}from"./chunk-PQ7QENVN.js";import{Eb as ie,Fb as ne,Gb as ae,Hb as oe,Ib as re,Jb as me,Kb as le,Lb as de,Mb as se,Nb as pe,Pb as ce,Wa as V,_a as L,ab as S,cb as Q,eb as j,gb as q,hb as N,ib as G,kb as J,sb as X,xb as Y,yb as Z,zb as ee}from"./chunk-CC66Z2HJ.js";import{Fb as p,Pb as n,Qb as i,Rb as u,Sb as _,Tb as h,Vb as T,Yb as C,Zc as A,_b as v,_c as B,bd as O,dc as P,dd as D,ec as w,fb as m,fc as b,gb as f,jc as F,kc as a,lc as R,mc as d,nc as H,oa as I,pa as y,sb as g,tc as k,xc as $,yb as s,zc as z}from"./chunk-ZV4WQW5U.js";import"./chunk-GAL4ENT6.js";function ve(e,l){if(e&1&&(n(0,"div",3)(1,"strong"),a(2,"\u{1F464} Cliente:"),i(),a(3),i()),e&2){let t=v();m(3),d(" ",t.data.usuario," ")}}function De(e,l){if(e&1&&(n(0,"mat-list-item")(1,"div",9)(2,"div",10),a(3),i(),n(4,"div",11),a(5),n(6,"strong"),a(7),i()()()()),e&2){let t=l.$implicit;m(3),R(t.producto==null?null:t.producto.nombre),m(2),H(" ",t.cantidad," x $",t.precio_unitario," = "),m(2),d("$",t.cantidad*t.precio_unitario,"")}}var fe=(()=>{class e{constructor(t,r){this.data=t,this.dialogRef=r}cerrar(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||e)(f(Z),f(Y))}}static{this.\u0275cmp=g({type:e,selectors:[["app-pedido-detalles"]],decls:26,vars:9,consts:[[1,"p-4"],[1,"f-s-20","f-w-600"],[1,"m-y-16"],[1,"mb-2"],["class","mb-2",4,"ngIf"],[1,"f-s-18","f-w-600"],[4,"ngFor","ngForOf"],[1,"text-end","mt-4"],["mat-flat-button","","color","primary",3,"click"],[1,"w-100"],[1,"f-w-500"],[1,"text-muted","f-s-14"]],template:function(r,o){r&1&&(n(0,"mat-card",0)(1,"h2",1),a(2),i(),u(3,"mat-divider",2),n(4,"div",3)(5,"strong"),a(6,"\u{1F4CC} Estado:"),i(),a(7),i(),n(8,"div",3)(9,"strong"),a(10,"\u{1F4C5} Fecha:"),i(),a(11),$(12,"date"),i(),s(13,ve,4,1,"div",4),n(14,"div",3)(15,"strong"),a(16,"\u{1F4B0} Total:"),i(),a(17),i(),u(18,"mat-divider",2),n(19,"h3",5),a(20,"\u{1F6CD} Productos"),i(),n(21,"mat-list"),s(22,De,8,4,"mat-list-item",6),i(),n(23,"div",7)(24,"button",8),C("click",function(){return o.cerrar()}),a(25,"Cerrar"),i()()()),r&2&&(m(2),d("\u{1F9FE} Pedido #",o.data.id,""),m(5),d(" ",o.data.estado," "),m(4),d(" ",z(12,6,o.data.fecha_pedido,"medium")," "),m(2),p("ngIf",o.data.usuario),m(4),d(" $",o.data.monto_total," "),m(5),p("ngForOf",o.data.items))},dependencies:[D,A,B,O,E,J,K,U,W,S],encapsulation:2})}}return e})();var Se=()=>[5,10,20];function xe(e,l){e&1&&(n(0,"th",20),a(1," ID "),i())}function Me(e,l){if(e&1&&(n(0,"td",21),a(1),i()),e&2){let t=l.$implicit;m(),d(" ",t.id," ")}}function Ee(e,l){e&1&&(n(0,"th",20),a(1," monto_total "),i())}function Pe(e,l){if(e&1&&(n(0,"td",21),a(1),i()),e&2){let t=l.$implicit;m(),d(" ",t.monto_total," ")}}function we(e,l){e&1&&(n(0,"th",20),a(1," Estado "),i())}function be(e,l){if(e&1&&(n(0,"td",21),a(1),i()),e&2){let t=l.$implicit;m(),d(" ",t.estado," ")}}function Ie(e,l){e&1&&(n(0,"th",20),a(1," Fecha del pedido "),i())}function ye(e,l){if(e&1&&(n(0,"td",21),a(1),i()),e&2){let t=l.$implicit;m(),d(" ",t.fecha_pedido," ")}}function Te(e,l){e&1&&u(0,"th",22)}function Fe(e,l){if(e&1){let t=T();n(0,"td",21)(1,"button",23)(2,"mat-icon"),a(3,"more_vert"),i()(),n(4,"mat-menu",null,0)(6,"button",24),C("click",function(){let o=I(t).$implicit,c=v();return y(c.verDetallePedido(o))}),n(7,"mat-icon"),a(8,"visibility"),i(),n(9,"span"),a(10,"Ver mas detalles"),i()()()()}if(e&2){let t=F(5);m(),p("matMenuTriggerFor",t)}}function Re(e,l){e&1&&u(0,"tr",25)}function He(e,l){e&1&&u(0,"tr",26)}var it=(()=>{class e{ngOnInit(){}ngAfterViewInit(){this.obtenerPedidos(),this.paginator.page.subscribe(()=>this.obtenerPedidos())}constructor(t,r){this.apiService=t,this.dialog=r,this.totalRegistros=0,this.paginaActual=1,this.columnas=["id","estado","monto_total","fecha_pedido","acciones"],this.dataSource=new ce}obtenerPedidos(){let t=this.paginator.pageIndex+1,r=this.paginator.pageSize;this.apiService.get("pedidos/",{page:t,page_size:r}).subscribe({next:o=>{this.dataSource.data=o.results,this.totalRegistros=o.count,this.dataSource.sort=this.sort,console.log("Productos obtenidos:",o)},error(o){console.error("Error al obtener pedidos",o)}})}verDetallePedido(t){this.dialog.open(fe,{data:t,width:"500px",maxHeight:"90vh"})}applyFilter(t){let r=t.target.value;this.dataSource.filter=r.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}static{this.\u0275fac=function(r){return new(r||e)(f(ue),f(ee))}}static{this.\u0275cmp=g({type:e,selectors:[["app-pedidos"]],viewQuery:function(r,o){if(r&1&&(P(x,5),P(M,5)),r&2){let c;w(c=b())&&(o.paginator=c.first),w(c=b())&&(o.sort=c.first)}},decls:30,vars:7,consts:[["menu","matMenu"],[1,"table-wrapper"],[1,"table-header"],["appearance","outline"],["matInput","","placeholder","Buscar Pedidos",3,"keyup"],["mat-raised-button","","color","primary"],[1,"table-container"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","monto_total"],["matColumnDef","estado"],["matColumnDef","fecha_pedido"],["matColumnDef","acciones"],["mat-header-cell","","class","f-w-600 f-s-14",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"table-footer"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"f-w-600","f-s-14"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,o){r&1&&(n(0,"div",1)(1,"div",2)(2,"mat-form-field",3)(3,"mat-label"),a(4,"Buscar"),i(),n(5,"input",4),C("keyup",function(_e){return o.applyFilter(_e)}),i()(),n(6,"div")(7,"button",5),a(8,"Agregar Pedido"),i()()(),n(9,"div",6)(10,"table",7),_(11,8),s(12,xe,2,0,"th",9)(13,Me,2,1,"td",10),h(),_(14,11),s(15,Ee,2,0,"th",9)(16,Pe,2,1,"td",10),h(),_(17,12),s(18,we,2,0,"th",9)(19,be,2,1,"td",10),h(),_(20,13),s(21,Ie,2,0,"th",9)(22,ye,2,1,"td",10),h(),_(23,14),s(24,Te,1,0,"th",15)(25,Fe,11,1,"td",10),h(),s(26,Re,1,0,"tr",16)(27,He,1,0,"tr",17),i()(),n(28,"div",18),u(29,"mat-paginator",19),i()()),r&2&&(m(10),p("dataSource",o.dataSource),m(16),p("matHeaderRowDef",o.columnas),m(),p("matRowDefColumns",o.columnas),m(2),p("length",o.totalRegistros)("pageSize",5)("pageSizeOptions",k(6,Se)))},dependencies:[D,E,L,V,j,N,q,G,S,Q,X,x,M,te,ie,ae,le,oe,ne,de,re,me,se,pe],encapsulation:2})}}return e})();export{it as PedidosComponent};
